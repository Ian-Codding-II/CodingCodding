<!-- searchbar.html -->

<style>
  #site-search form {
    background-color: #e4c594;
    width: 300px;
    height: 44px;
    border-radius: 5px;
    display: flex;
    align-items: center;
    margin: 20px auto;
  }

  #site-search input {
    all: unset;
    font: 16px system-ui;
    color: #ac792a;
    height: 100%;
    width: 100%;
    padding: 6px 10px;
  }

  #site-search ::placeholder {
    color: #ac792a;
    opacity: 0.7;
  }

  #site-search svg {
    color: #ac792a;
    fill: currentColor;
    width: 24px;
    height: 24px;
    padding: 10px;
  }

  #site-search button {
    all: unset;
    cursor: pointer;
    width: 44px;
    height: 44px;
  }

  #results {
    max-width: 600px;
    margin: 10px auto;
    padding: 10px;
    font-family: system-ui, sans-serif;
    color: #5e4434;
  }

  #results ul {
    list-style-type: none;
    padding-left: 0;
  }

  #results li {
    margin-bottom: 1em;
  }

  #results a {
    font-weight: bold;
    color: #5e4434;
    text-decoration: none;
  }

  #results a:hover {
    text-decoration: underline;
  }
</style>

<div id="site-search">
  <form role="search" id="form">
    <input
      type="search"
      id="query"
      name="q"
      placeholder="Search..."
      aria-label="Search through site content"
    />
    <button type="submit" aria-label="Search">
      <svg viewBox="0 0 1024 1024" width="20" height="20" fill="currentColor">
        <path class="path1"
          d="M848.471 928l-263.059-263.059c-48.941 36.706-110.118 55.059-177.412 55.059-171.294 0-312-140.706-312-312s140.706-312 312-312c171.294 0 312 140.706 312 312 0 67.294-24.471 128.471-55.059 177.412l263.059 263.059-79.529 79.529zM189.623 408.078c0 121.364 97.091 218.455 218.455 218.455s218.455-97.091 218.455-218.455c0-121.364-103.159-218.455-218.455-218.455-121.364 0-218.455 97.091-218.455 218.455z">
        </path>
      </svg>
    </button>
  </form>
</div>

<div id="results"></div>

<noscript>
  <style>
    #site-search {
      display: none;
    }
  </style>
  <p>Please enable JavaScript to use the site search feature.</p>
</noscript>

<!-- Add Lunr.js and your own search logic -->
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script>
  let idx = null;
  let pages = [];

  fetch('/CodingCodding/search.json')
    .then(res => res.json())
    .then(data => {
      pages = data;
      idx = lunr(function () {
        this.ref('url');
        this.field('title');
        this.field('content');

        pages.forEach(doc => this.add(doc));
      });
    });

  const form = document.getElementById('form');
  const queryInput = document.getElementById('query');
  const resultsContainer = document.getElementById('results');

  form.addEventListener('submit', function (e) {
    e.preventDefault();
    const query = queryInput.value.trim();
    if (!query || !idx) return;

    const results = idx.search(query);
    resultsContainer.innerHTML = '';

    if (results.length === 0) {
      resultsContainer.innerHTML = '<p>No results found.</p>';
      return;
    }

    const ul = document.createElement('ul');
    results.forEach(result => {
      const page = pages.find(p => p.url === result.ref);
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = page.url;
      a.textContent = page.title;
      li.appendChild(a);
      ul.appendChild(li);
    });
    resultsContainer.appendChild(ul);
  });
</script>
